drop sequence filenum;
drop sequence symnum;
drop table files;
drop table symbols;
drop table indexes;
drop table releases;
drop table status;

create sequence filenum cache 50;
create sequence symnum cache 50;

create table files (
	filename	varchar,
	revision	varchar,
	fileid		int,
	primary key	(fileid),
	unique		(filename, revision)

);

create table symbols (
	symname		varchar,
	symid		int,
	primary key	(symid),
	unique		(symname)

);

create table indexes (
	symid		int		 references symbols,
	fileid		int		 references files,
	line		int,
	type		varchar
);

/*
create table relations (
	symid		int		 references symbols,
	release		varchar,
	rsymid		int		 references symbols,
	reltype		varchar
);
*/

create table releases 
	(fileid		int		 references files,
	release		varchar,
	primary key	(fileid)
);

create table status
	(fileid		int		 references files,
	status		int,
	primary key	(fileid)
);

create index symbolindex on symbols using btree (symname);

grant select on files to public;
grant select on symbols to public;
grant select on indexes to public;
grant select on relations to public;
grant select on releases to public;
grant select on status to public;

