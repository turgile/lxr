use lxr2

drop table files
drop table symbols
drop table indexes
drop table relations
drop table releases
go

create table files (
	filename	varchar(80),
	revision	varchar(80),
	primary key	(filename, revision) 
)

create table symbols (
	symname		varchar(80),
	primary key	(symname),
)

create table indexes (
	symname		varchar(80)		references symbols,
	filename	varchar(80),
	revision	varchar(80),
	line		int,
	type		varchar(80),
	foreign key	(filename, revision)	references files
)

create table relations (
	symname		varchar(80)		references symbols,
	release		varchar(80),
	rsymid		varchar(80)		references symbols,
	reltype		varchar(80)
)

create table releases (
	filename	varchar(80),
	revision	varchar(80),
	release		varchar(80),
	foreign key	(filename, revision) references files
)

create index symbolindex on symbols (symname)

grant select on symbols to public
